2025-05-09 03:41:36 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 03:41:38 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 03:41:46 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 03:42:10 - services.voice - INFO - Starting audio generation for ID: 5
2025-05-09 03:42:10 - services.voice - INFO - Transcribing audio file: http://localhost:8000/static/audio/record_7da80702-bda9-44db-a99e-33bdcfab7914_1746733330.wav
2025-05-09 03:42:10 - services.voice - INFO - Starting audio transcription for file: http://localhost:8000/static/audio/record_7da80702-bda9-44db-a99e-33bdcfab7914_1746733330.wav
2025-05-09 03:42:10 - services.voice - INFO - Loading Vosk model from: D:\PyCharm Project\CCF\app_latest\services\vosk-model-small-cn-0.22
2025-05-09 03:42:10 - services.voice - INFO - Reading audio file content
2025-05-09 03:42:10 - services.voice - INFO - Attempting to read file: http://localhost:8000/static/audio/record_7da80702-bda9-44db-a99e-33bdcfab7914_1746733330.wav
2025-05-09 03:42:10 - services.voice - INFO - Converted local URL to path: /static/audio/record_7da80702-bda9-44db-a99e-33bdcfab7914_1746733330.wav
2025-05-09 03:42:10 - services.voice - INFO - Current directory: D:\PyCharm Project\CCF\app_latest
2025-05-09 03:42:10 - services.voice - INFO - Full file path: D:\PyCharm Project\CCF\app_latest\static/audio/record_7da80702-bda9-44db-a99e-33bdcfab7914_1746733330.wav
2025-05-09 03:42:10 - services.voice - INFO - File size: 293804 bytes
2025-05-09 03:42:10 - services.voice - INFO - Reading file content...
2025-05-09 03:42:10 - services.voice - INFO - Successfully read 293804 bytes
2025-05-09 03:42:10 - services.voice - INFO - Validating audio file type
2025-05-09 03:42:10 - services.voice - INFO - Audio file type: audio/wav
2025-05-09 03:42:10 - services.voice - INFO - Generated unique filename: train_6da02352-5831-44ed-a41f-72b09821bde6_1746733330.wav
2025-05-09 03:42:10 - services.voice - INFO - Importing pydub
2025-05-09 03:42:10 - services.voice - INFO - Converting audio data to AudioSegment
2025-05-09 03:42:10 - services.voice - INFO - Processing WAV file
2025-05-09 03:42:10 - services.voice - INFO - Converting audio to 16kHz mono
2025-05-09 03:42:10 - services.voice - INFO - Exporting to WAV format
2025-05-09 03:42:10 - services.voice - INFO - Audio processing completed successfully
2025-05-09 03:42:10 - services.voice - INFO - Creating speech recognizer
2025-05-09 03:42:11 - services.voice - INFO - Processing audio data with Vosk
2025-05-09 03:42:12 - services.voice - INFO - Successfully transcribed text: ä½ ä»Šå¹´å‡ å²äº†
2025-05-09 03:42:12 - services.voice - INFO - Transcribed text: ä½ ä»Šå¹´å‡ å²äº†
2025-05-09 03:42:12 - services.voice - INFO - Saving chat to database
2025-05-09 03:42:12 - services.voice - INFO - Getting AI response
2025-05-09 03:42:19 - services.voice - INFO - AI response: æˆ‘æ˜¯ **DeepSeek Chat**ï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸åˆ›é€ ã€‚æˆ‘çš„çŸ¥è¯†æˆªæ­¢åˆ° **2024å¹´7æœˆ**ï¼Œå¦‚æœä»é‚£æ—¶ç®—èµ·ï¼Œæˆ‘å¤§æ¦‚ **ä¸åˆ°1å²**ï¼ğŸ‚  

ä¸è¿‡ï¼Œæˆ‘çš„çŸ¥è¯†å‚¨å¤‡å¯æ˜¯ç›¸å½“ä¸°å¯Œçš„ï¼Œå¯ä»¥å¸®ä½ è§£ç­”å„ç§é—®é¢˜ï¼ğŸ˜Š ä½ æœ‰ä»€ä¹ˆæƒ³èŠçš„å—ï¼Ÿ
2025-05-09 03:42:19 - services.voice - INFO - Saving AI response to database
2025-05-09 03:42:19 - services.voice - INFO - Initializing OpenAI client
2025-05-09 03:42:20 - services.voice - INFO - Generating speech with model: FunAudioLLM/CosyVoice2-0.5B, voice: speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc
2025-05-09 03:42:20 - services.voice - INFO - Request parameters: model=FunAudioLLM/CosyVoice2-0.5B, voice=speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc, input_length=116
2025-05-09 03:42:20 - services.voice - INFO - API Key: sk-swldh...
2025-05-09 03:42:20 - services.voice - INFO - Base URL: https://api.siliconflow.cn/v1
2025-05-09 03:42:20 - services.voice - INFO - Using test text: ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚
2025-05-09 03:42:20 - services.voice - INFO - Request parameters: {'model': 'FunAudioLLM/CosyVoice2-0.5B', 'voice': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'input': 'ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚', 'response_format': 'mp3'}
2025-05-09 03:42:20 - services.voice - INFO - Making direct API call with httpx...
2025-05-09 03:42:20 - services.voice - INFO - Request URL: https://api.siliconflow.cn/v1/audio/speech
2025-05-09 03:42:20 - services.voice - INFO - Request Headers: {'Authorization': 'Bearer sk-swldh...'}
2025-05-09 03:42:20 - services.voice - INFO - Request Body: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚", "response_format": "mp3"}
2025-05-09 03:42:23 - services.voice - INFO - Response Status Code: 500
2025-05-09 03:42:23 - services.voice - INFO - Response Headers: {'date': 'Thu, 08 May 2025 19:42:21 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 03:42:23 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 03:42:23 - services.voice - ERROR - Error Code: 50500
2025-05-09 03:42:23 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 03:42:23 - services.voice - ERROR - Error Data: None
2025-05-09 03:42:23 - services.voice - ERROR - Unexpected error during API call: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 367, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 03:42:23 - services.voice - ERROR - API call failed: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 03:42:23 - services.voice - ERROR - API response: None
2025-05-09 03:42:23 - services.voice - WARNING - Attempt 1 failed: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 03:42:23 - services.voice - INFO - Waiting 1 seconds before next attempt
2025-05-09 03:42:24 - services.voice - INFO - Using test text: ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚
2025-05-09 03:42:24 - services.voice - INFO - Request parameters: {'model': 'FunAudioLLM/CosyVoice2-0.5B', 'voice': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'input': 'ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚', 'response_format': 'mp3'}
2025-05-09 03:42:24 - services.voice - INFO - Making direct API call with httpx...
2025-05-09 03:42:24 - services.voice - INFO - Request URL: https://api.siliconflow.cn/v1/audio/speech
2025-05-09 03:42:24 - services.voice - INFO - Request Headers: {'Authorization': 'Bearer sk-swldh...'}
2025-05-09 03:42:24 - services.voice - INFO - Request Body: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚", "response_format": "mp3"}
2025-05-09 03:42:27 - services.voice - INFO - Response Status Code: 500
2025-05-09 03:42:27 - services.voice - INFO - Response Headers: {'date': 'Thu, 08 May 2025 19:42:25 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 03:42:27 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 03:42:27 - services.voice - ERROR - Error Code: 50500
2025-05-09 03:42:27 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 03:42:27 - services.voice - ERROR - Error Data: None
2025-05-09 03:42:27 - services.voice - ERROR - Unexpected error during API call: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 367, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 03:42:27 - services.voice - ERROR - API call failed: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 03:42:27 - services.voice - ERROR - API response: None
2025-05-09 03:42:27 - services.voice - WARNING - Attempt 2 failed: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 03:42:27 - services.voice - INFO - Waiting 2 seconds before next attempt
2025-05-09 03:42:29 - services.voice - INFO - Using test text: ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚
2025-05-09 03:42:29 - services.voice - INFO - Request parameters: {'model': 'FunAudioLLM/CosyVoice2-0.5B', 'voice': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'input': 'ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚', 'response_format': 'mp3'}
2025-05-09 03:42:29 - services.voice - INFO - Making direct API call with httpx...
2025-05-09 03:42:29 - services.voice - INFO - Request URL: https://api.siliconflow.cn/v1/audio/speech
2025-05-09 03:42:29 - services.voice - INFO - Request Headers: {'Authorization': 'Bearer sk-swldh...'}
2025-05-09 03:42:29 - services.voice - INFO - Request Body: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚", "response_format": "mp3"}
2025-05-09 03:42:32 - services.voice - INFO - Response Status Code: 500
2025-05-09 03:42:32 - services.voice - INFO - Response Headers: {'date': 'Thu, 08 May 2025 19:42:30 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 03:42:32 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 03:42:32 - services.voice - ERROR - Error Code: 50500
2025-05-09 03:42:32 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 03:42:32 - services.voice - ERROR - Error Data: None
2025-05-09 03:42:32 - services.voice - ERROR - Unexpected error during API call: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 367, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 03:42:32 - services.voice - ERROR - API call failed: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 03:42:32 - services.voice - ERROR - API response: None
2025-05-09 03:42:32 - services.voice - WARNING - Attempt 3 failed: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 03:42:32 - services.voice - ERROR - All 3 attempts failed. Last error: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 03:42:32 - services.voice - ERROR - Error during speech generation: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 367, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 450, in generate_audio
    raise last_error
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 433, in generate_audio
    raise api_error
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 429, in generate_audio
    raise HTTPException(500, f"APIè°ƒç”¨å¤±è´¥: {str(e)}")
fastapi.exceptions.HTTPException: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 03:42:32 - services.voice - ERROR - HTTP Exception in generate_audio: 500: è¯­éŸ³ç”Ÿæˆå¤±è´¥: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 03:44:06 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:01:23 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:01:24 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:02:28 - services.voice - INFO - Starting audio generation for ID: 5
2025-05-09 04:02:28 - services.voice - INFO - Transcribing audio file: http://localhost:8000/static/audio/record_58d92e45-7f88-4221-a335-bf65fd344c20_1746734548.wav
2025-05-09 04:02:28 - services.voice - INFO - Starting audio transcription for file: http://localhost:8000/static/audio/record_58d92e45-7f88-4221-a335-bf65fd344c20_1746734548.wav
2025-05-09 04:02:28 - services.voice - INFO - Loading Vosk model from: D:\PyCharm Project\CCF\app_latest\services\vosk-model-small-cn-0.22
2025-05-09 04:02:28 - services.voice - INFO - Reading audio file content
2025-05-09 04:02:28 - services.voice - INFO - Attempting to read file: http://localhost:8000/static/audio/record_58d92e45-7f88-4221-a335-bf65fd344c20_1746734548.wav
2025-05-09 04:02:28 - services.voice - INFO - Converted local URL to path: /static/audio/record_58d92e45-7f88-4221-a335-bf65fd344c20_1746734548.wav
2025-05-09 04:02:28 - services.voice - INFO - Current directory: D:\PyCharm Project\CCF\app_latest
2025-05-09 04:02:28 - services.voice - INFO - Full file path: D:\PyCharm Project\CCF\app_latest\static/audio/record_58d92e45-7f88-4221-a335-bf65fd344c20_1746734548.wav
2025-05-09 04:02:28 - services.voice - INFO - File size: 374444 bytes
2025-05-09 04:02:28 - services.voice - INFO - Reading file content...
2025-05-09 04:02:28 - services.voice - INFO - Successfully read 374444 bytes
2025-05-09 04:02:28 - services.voice - INFO - Validating audio file type
2025-05-09 04:02:28 - services.voice - INFO - Audio file type: audio/wav
2025-05-09 04:02:28 - services.voice - INFO - Generated unique filename: train_89ca7801-8848-46f0-b830-2780e6bf67b9_1746734548.wav
2025-05-09 04:02:28 - services.voice - INFO - Importing pydub
2025-05-09 04:02:28 - services.voice - INFO - Converting audio data to AudioSegment
2025-05-09 04:02:28 - services.voice - INFO - Processing WAV file
2025-05-09 04:02:28 - services.voice - INFO - Converting audio to 16kHz mono
2025-05-09 04:02:28 - services.voice - INFO - Exporting to WAV format
2025-05-09 04:02:28 - services.voice - INFO - Audio processing completed successfully
2025-05-09 04:02:28 - services.voice - INFO - Creating speech recognizer
2025-05-09 04:02:29 - services.voice - INFO - Processing audio data with Vosk
2025-05-09 04:02:31 - services.voice - INFO - Successfully transcribed text: ä½ ä»Šå¹´å‡ å²å•¦
2025-05-09 04:02:31 - services.voice - INFO - Transcribed text: ä½ ä»Šå¹´å‡ å²å•¦
2025-05-09 04:02:31 - services.voice - INFO - Saving chat to database
2025-05-09 04:02:31 - services.voice - INFO - Getting AI response
2025-05-09 04:02:38 - services.voice - INFO - AI response: å“ˆå“ˆï¼Œæˆ‘å…¶å®æ˜¯ä¸ªAIåŠ©æ‰‹ï¼Œæ²¡æœ‰çœŸå®çš„å¹´é¾„æ¦‚å¿µå“¦ï½ä¸è¿‡å¦‚æœä»æŠ€æœ¯è§’åº¦ç®—çš„è¯ï¼Œæˆ‘çš„çŸ¥è¯†åº“æ›´æ–°åˆ°2023å¹´ï¼Œä½ å¯ä»¥ç†è§£ä¸ºæˆ‘çš„â€œå‡ºç”Ÿå¹´ä»½â€æ˜¯é‚£ä¹‹å‰å‘¢ï¼ğŸ˜„ éœ€è¦å¸®å¿™çš„è¯ï¼Œæˆ‘éšæ—¶éƒ½åœ¨ï½
2025-05-09 04:02:38 - services.voice - INFO - Saving AI response to database
2025-05-09 04:02:38 - services.voice - INFO - Initializing OpenAI client
2025-05-09 04:02:38 - services.voice - INFO - Generating speech with model: FunAudioLLM/CosyVoice2-0.5B, voice: speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc
2025-05-09 04:02:38 - services.voice - INFO - Request parameters: model=FunAudioLLM/CosyVoice2-0.5B, voice=speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc, input_length=86
2025-05-09 04:02:38 - services.voice - INFO - API Key: sk-swldh...
2025-05-09 04:02:38 - services.voice - INFO - Base URL: https://api.siliconflow.cn/v1
2025-05-09 04:02:38 - services.voice - INFO - Using test text: ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚
2025-05-09 04:02:38 - services.voice - INFO - Request parameters: {'model': 'FunAudioLLM/CosyVoice2-0.5B', 'voice': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'input': 'ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚', 'response_format': 'mp3'}
2025-05-09 04:02:38 - services.voice - INFO - Making direct API call with httpx...
2025-05-09 04:02:38 - services.voice - INFO - Request URL: https://api.siliconflow.cn/v1/audio/speech
2025-05-09 04:02:38 - services.voice - INFO - Request Headers: {'Authorization': 'Bearer sk-swldh...'}
2025-05-09 04:02:38 - services.voice - INFO - Request Body: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚", "response_format": "mp3"}
2025-05-09 04:02:40 - services.voice - INFO - Response Status Code: 500
2025-05-09 04:02:40 - services.voice - INFO - Response Headers: {'date': 'Thu, 08 May 2025 20:02:41 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 04:02:40 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 04:02:40 - services.voice - ERROR - Error Code: 50500
2025-05-09 04:02:40 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 04:02:40 - services.voice - ERROR - Error Data: None
2025-05-09 04:02:40 - services.voice - ERROR - Unexpected error during API call: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 367, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:02:40 - services.voice - ERROR - API call failed: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:02:40 - services.voice - ERROR - API response: None
2025-05-09 04:02:40 - services.voice - WARNING - Attempt 1 failed: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:02:40 - services.voice - INFO - Waiting 1 seconds before next attempt
2025-05-09 04:02:41 - services.voice - INFO - Using test text: ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚
2025-05-09 04:02:41 - services.voice - INFO - Request parameters: {'model': 'FunAudioLLM/CosyVoice2-0.5B', 'voice': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'input': 'ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚', 'response_format': 'mp3'}
2025-05-09 04:02:41 - services.voice - INFO - Making direct API call with httpx...
2025-05-09 04:02:41 - services.voice - INFO - Request URL: https://api.siliconflow.cn/v1/audio/speech
2025-05-09 04:02:41 - services.voice - INFO - Request Headers: {'Authorization': 'Bearer sk-swldh...'}
2025-05-09 04:02:41 - services.voice - INFO - Request Body: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚", "response_format": "mp3"}
2025-05-09 04:02:43 - services.voice - INFO - Response Status Code: 500
2025-05-09 04:02:43 - services.voice - INFO - Response Headers: {'date': 'Thu, 08 May 2025 20:02:44 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 04:02:43 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 04:02:43 - services.voice - ERROR - Error Code: 50500
2025-05-09 04:02:43 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 04:02:43 - services.voice - ERROR - Error Data: None
2025-05-09 04:02:43 - services.voice - ERROR - Unexpected error during API call: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 367, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:02:43 - services.voice - ERROR - API call failed: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:02:43 - services.voice - ERROR - API response: None
2025-05-09 04:02:43 - services.voice - WARNING - Attempt 2 failed: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:02:43 - services.voice - INFO - Waiting 2 seconds before next attempt
2025-05-09 04:02:45 - services.voice - INFO - Using test text: ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚
2025-05-09 04:02:45 - services.voice - INFO - Request parameters: {'model': 'FunAudioLLM/CosyVoice2-0.5B', 'voice': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'input': 'ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚', 'response_format': 'mp3'}
2025-05-09 04:02:45 - services.voice - INFO - Making direct API call with httpx...
2025-05-09 04:02:45 - services.voice - INFO - Request URL: https://api.siliconflow.cn/v1/audio/speech
2025-05-09 04:02:45 - services.voice - INFO - Request Headers: {'Authorization': 'Bearer sk-swldh...'}
2025-05-09 04:02:45 - services.voice - INFO - Request Body: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚", "response_format": "mp3"}
2025-05-09 04:02:47 - services.voice - INFO - Response Status Code: 500
2025-05-09 04:02:47 - services.voice - INFO - Response Headers: {'date': 'Thu, 08 May 2025 20:02:48 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 04:02:47 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 04:02:47 - services.voice - ERROR - Error Code: 50500
2025-05-09 04:02:47 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 04:02:47 - services.voice - ERROR - Error Data: None
2025-05-09 04:02:47 - services.voice - ERROR - Unexpected error during API call: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 367, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:02:47 - services.voice - ERROR - API call failed: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:02:47 - services.voice - ERROR - API response: None
2025-05-09 04:02:47 - services.voice - WARNING - Attempt 3 failed: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:02:47 - services.voice - ERROR - All 3 attempts failed. Last error: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:02:47 - services.voice - ERROR - Error during speech generation: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 367, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 450, in generate_audio
    raise last_error
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 433, in generate_audio
    raise api_error
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 429, in generate_audio
    raise HTTPException(500, f"APIè°ƒç”¨å¤±è´¥: {str(e)}")
fastapi.exceptions.HTTPException: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:02:47 - services.voice - ERROR - HTTP Exception in generate_audio: 500: è¯­éŸ³ç”Ÿæˆå¤±è´¥: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:12:28 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:12:30 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:12:39 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:12:40 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:14:05 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:14:09 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:14:10 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:14:11 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:14:11 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:14:16 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:14:18 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:14:39 - services.voice - INFO - Starting audio generation for ID: 5
2025-05-09 04:14:39 - services.voice - INFO - Transcribing audio file: http://localhost:8000/static/audio/record_2a06f54d-3b7b-41e7-93c0-0141bad4ae24_1746735279.wav
2025-05-09 04:14:39 - services.voice - ERROR - Unexpected error in generate_audio: 'VoiceService' object has no attribute 'transcribe_audio_file'
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 218, in generate_audio
    final_result = await self.transcribe_audio_file(audio_url)  # è¯†åˆ«æˆæ–‡å­—
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'VoiceService' object has no attribute 'transcribe_audio_file'
2025-05-09 04:19:17 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:21:06 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:21:09 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:21:09 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:21:11 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:21:11 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:21:19 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:21:20 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:22:03 - services.voice - INFO - Starting audio generation for ID: 5
2025-05-09 04:22:03 - services.voice - INFO - Transcribing audio file: http://localhost:8000/static/audio/record_0eb9962d-7f39-4bb3-9e6b-65ebae626546_1746735723.wav
2025-05-09 04:22:03 - services.voice - INFO - Starting audio transcription for file: http://localhost:8000/static/audio/record_0eb9962d-7f39-4bb3-9e6b-65ebae626546_1746735723.wav
2025-05-09 04:22:03 - services.voice - ERROR - Audio file not found: D:\PyCharm Project\CCF\app_latest\http://localhost:8000/static/audio/record_0eb9962d-7f39-4bb3-9e6b-65ebae626546_1746735723.wav
2025-05-09 04:22:03 - services.voice - ERROR - Transcription error: 404: éŸ³é¢‘æ–‡ä»¶ä¸å­˜åœ¨: http://localhost:8000/static/audio/record_0eb9962d-7f39-4bb3-9e6b-65ebae626546_1746735723.wav
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 364, in transcribe_audio_file
    raise HTTPException(status_code=404, detail=f"éŸ³é¢‘æ–‡ä»¶ä¸å­˜åœ¨: {audio_url}")
fastapi.exceptions.HTTPException: 404: éŸ³é¢‘æ–‡ä»¶ä¸å­˜åœ¨: http://localhost:8000/static/audio/record_0eb9962d-7f39-4bb3-9e6b-65ebae626546_1746735723.wav
2025-05-09 04:22:03 - services.voice - ERROR - HTTP Exception in generate_audio: 500: è¯­éŸ³è¯†åˆ«å¤±è´¥: 404: éŸ³é¢‘æ–‡ä»¶ä¸å­˜åœ¨: http://localhost:8000/static/audio/record_0eb9962d-7f39-4bb3-9e6b-65ebae626546_1746735723.wav
2025-05-09 04:24:20 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:24:24 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:24:24 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:24:25 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:24:25 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:24:27 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:24:28 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:24:45 - services.voice - INFO - Starting audio generation for ID: 5
2025-05-09 04:24:45 - services.voice - INFO - Transcribing audio file: http://localhost:8000/static/audio/record_e835ab78-4069-470c-a7fa-831a01b36980_1746735885.wav
2025-05-09 04:24:45 - services.voice - INFO - Starting audio transcription for file: http://localhost:8000/static/audio/record_e835ab78-4069-470c-a7fa-831a01b36980_1746735885.wav
2025-05-09 04:24:46 - services.voice - ERROR - Vosk model not found at: D:\PyCharm Project\CCF\app_latest\services\vosk-model-small-cn
2025-05-09 04:24:46 - services.voice - ERROR - Transcription error: 500: è¯­éŸ³è¯†åˆ«æ¨¡å‹æœªæ‰¾åˆ°
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 397, in transcribe_audio_file
    raise HTTPException(status_code=500, detail="è¯­éŸ³è¯†åˆ«æ¨¡å‹æœªæ‰¾åˆ°")
fastapi.exceptions.HTTPException: 500: è¯­éŸ³è¯†åˆ«æ¨¡å‹æœªæ‰¾åˆ°
2025-05-09 04:24:46 - services.voice - ERROR - HTTP Exception in generate_audio: 500: è¯­éŸ³è¯†åˆ«å¤±è´¥: 500: è¯­éŸ³è¯†åˆ«æ¨¡å‹æœªæ‰¾åˆ°
2025-05-09 04:28:35 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:28:36 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:28:55 - services.voice - INFO - Starting audio generation for ID: 5
2025-05-09 04:28:55 - services.voice - INFO - Transcribing audio file: http://localhost:8000/static/audio/record_4676d8cd-52ea-48cd-bb02-f435f63c09f4_1746736135.wav
2025-05-09 04:28:55 - services.voice - INFO - Starting audio transcription for file: http://localhost:8000/static/audio/record_4676d8cd-52ea-48cd-bb02-f435f63c09f4_1746736135.wav
2025-05-09 04:28:58 - services.voice - WARNING - Failed to delete temporary file D:\PyCharm Project\CCF\app_latest\static\temp\temp_8053eac9-17ce-4520-9e12-002648f11510.wav: [WinError 32] å¦ä¸€ä¸ªç¨‹åºæ­£åœ¨ä½¿ç”¨æ­¤æ–‡ä»¶ï¼Œè¿›ç¨‹æ— æ³•è®¿é—®ã€‚: 'D:\\PyCharm Project\\CCF\\app_latest\\static\\temp\\temp_8053eac9-17ce-4520-9e12-002648f11510.wav'
2025-05-09 04:28:58 - services.voice - INFO - Transcription completed: ä½  ä»Šå¹´ å‡ å² äº†
2025-05-09 04:28:59 - services.voice - INFO - Transcribed text: ä½  ä»Šå¹´ å‡ å² äº†
2025-05-09 04:28:59 - services.voice - INFO - Saving chat to database
2025-05-09 04:28:59 - services.voice - INFO - Getting AI response
2025-05-09 04:29:06 - services.voice - INFO - AI response: æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæ²¡æœ‰å¹´é¾„çš„æ¦‚å¿µå“¦ï¼ä¸è¿‡å¦‚æœä½ å¥½å¥‡æˆ‘çš„â€œå‡ºç”Ÿâ€æ—¶é—´ï¼Œæˆ‘çš„çŸ¥è¯†æˆªæ­¢åˆ°2023å¹´ï¼Œä¹‹åçš„çŸ¥è¯†æˆ‘å°±ä¸çŸ¥é“å•¦ï½ ä½ å¯ä»¥æŠŠæˆ‘å½“æˆä¸€ä¸ªæ°¸è¿œâ€œå½“å‰ç‰ˆæœ¬â€çš„æ™ºèƒ½å·¥å…·ï¼ ğŸ˜Š  

æœ‰ä»€ä¹ˆå…¶ä»–é—®é¢˜æƒ³èŠçš„å—ï¼Ÿ
2025-05-09 04:29:06 - services.voice - INFO - Saving AI response to database
2025-05-09 04:29:06 - services.voice - INFO - Request parameters: {'model': 'FunAudioLLM/CosyVoice2-0.5B', 'voice': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'input': 'æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæ²¡æœ‰å¹´é¾„çš„æ¦‚å¿µå“¦ï¼ä¸è¿‡å¦‚æœä½ å¥½å¥‡æˆ‘çš„â€œå‡ºç”Ÿâ€æ—¶é—´ï¼Œæˆ‘çš„çŸ¥è¯†æˆªæ­¢åˆ°2023å¹´ï¼Œä¹‹åçš„çŸ¥è¯†æˆ‘å°±ä¸çŸ¥é“å•¦ï½ ä½ å¯ä»¥æŠŠæˆ‘å½“æˆä¸€ä¸ªæ°¸è¿œâ€œå½“å‰ç‰ˆæœ¬â€çš„æ™ºèƒ½å·¥å…·ï¼ ğŸ˜Š  \n\næœ‰ä»€ä¹ˆå…¶ä»–é—®é¢˜æƒ³èŠçš„å—ï¼Ÿ', 'response_format': 'mp3'}
2025-05-09 04:29:06 - services.voice - INFO - Making direct API call with httpx...
2025-05-09 04:29:06 - services.voice - INFO - Request URL: https://api.siliconflow.cn/v1/audio/speech
2025-05-09 04:29:06 - services.voice - INFO - Request Headers: {'Authorization': 'Bearer sk-ijbcb...'}
2025-05-09 04:29:06 - services.voice - INFO - Request Body: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæ²¡æœ‰å¹´é¾„çš„æ¦‚å¿µå“¦ï¼ä¸è¿‡å¦‚æœä½ å¥½å¥‡æˆ‘çš„â€œå‡ºç”Ÿâ€æ—¶é—´ï¼Œæˆ‘çš„çŸ¥è¯†æˆªæ­¢åˆ°2023å¹´ï¼Œä¹‹åçš„çŸ¥è¯†æˆ‘å°±ä¸çŸ¥é“å•¦ï½ ä½ å¯ä»¥æŠŠæˆ‘å½“æˆä¸€ä¸ªæ°¸è¿œâ€œå½“å‰ç‰ˆæœ¬â€çš„æ™ºèƒ½å·¥å…·ï¼ ğŸ˜Š  \n\næœ‰ä»€ä¹ˆå…¶ä»–é—®é¢˜æƒ³èŠçš„å—ï¼Ÿ", "response_format": "mp3"}
2025-05-09 04:29:07 - services.voice - INFO - Response Status Code: 403
2025-05-09 04:29:07 - services.voice - INFO - Response Headers: {'date': 'Thu, 08 May 2025 20:29:08 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '57', 'connection': 'keep-alive'}
2025-05-09 04:29:07 - services.voice - ERROR - API Error Response: {"code": 30000, "message": "Illegal operation.", "data": null}
2025-05-09 04:29:07 - services.voice - ERROR - Error Code: 30000
2025-05-09 04:29:07 - services.voice - ERROR - Error Message: Illegal operation.
2025-05-09 04:29:07 - services.voice - ERROR - Error Data: None
2025-05-09 04:29:07 - services.voice - ERROR - Unexpected error during API call: 403: API error: {'code': 30000, 'message': 'Illegal operation.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 276, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 403: API error: {'code': 30000, 'message': 'Illegal operation.', 'data': None}
2025-05-09 04:29:07 - services.voice - ERROR - Error during speech generation: 500: APIè°ƒç”¨å¤±è´¥: 403: API error: {'code': 30000, 'message': 'Illegal operation.', 'data': None}
2025-05-09 04:29:07 - services.voice - ERROR - HTTP Exception in generate_audio: 500: è¯­éŸ³ç”Ÿæˆå¤±è´¥: 500: APIè°ƒç”¨å¤±è´¥: 403: API error: {'code': 30000, 'message': 'Illegal operation.', 'data': None}
2025-05-09 04:33:35 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:35:24 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:35:25 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:35:45 - services.voice - INFO - Starting audio generation for ID: 5
2025-05-09 04:35:45 - services.voice - INFO - Digital human info: {'id': 5, 'name': 'å°ä¸½', 'gender': 'å¥³', 'age': 18, 'phone': '15626273815', 'description': '1', 'referenceAudio': 'http://localhost:8000/static/audio/ref_ca23ad5a-b396-4c16-8bb5-2d568eb2049b_1746729875.mp3', 'trainingAudio': 'http://localhost:8000/static/audio/train_30059ed1-53a8-4b4e-a49b-27bf185e4470_1746729873.mp3', 'avatar': 'http://localhost:8000/static/uploads/avatars/f56f55c1-a2d3-4263-88b9-318cc76f89ab_1746729871.png', 'video_path': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'patient_info_path': None, 'created_at': datetime.datetime(2025, 5, 9, 2, 44, 38), 'user_id': 2, 'voice_path': None}
2025-05-09 04:35:45 - services.voice - INFO - Video path: speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc
2025-05-09 04:35:45 - services.voice - INFO - Transcribing audio file: http://localhost:8000/static/audio/record_765d12bd-8553-4e8b-84b9-f201c3b45ecb_1746736545.wav
2025-05-09 04:35:45 - services.voice - INFO - Starting audio transcription for file: http://localhost:8000/static/audio/record_765d12bd-8553-4e8b-84b9-f201c3b45ecb_1746736545.wav
2025-05-09 04:35:49 - services.voice - WARNING - Failed to delete temporary file D:\PyCharm Project\CCF\app_latest\static\temp\temp_b56c808c-b5f4-45bb-b192-6437d6c24054.wav: [WinError 32] å¦ä¸€ä¸ªç¨‹åºæ­£åœ¨ä½¿ç”¨æ­¤æ–‡ä»¶ï¼Œè¿›ç¨‹æ— æ³•è®¿é—®ã€‚: 'D:\\PyCharm Project\\CCF\\app_latest\\static\\temp\\temp_b56c808c-b5f4-45bb-b192-6437d6c24054.wav'
2025-05-09 04:35:49 - services.voice - INFO - Transcription completed: ä½  ä»Šå¹´ å‡ å² å•¦ ä½  å« ä»€ä¹ˆ åå­— å•Š
2025-05-09 04:35:49 - services.voice - INFO - Transcribed text: ä½  ä»Šå¹´ å‡ å² å•¦ ä½  å« ä»€ä¹ˆ åå­— å•Š
2025-05-09 04:35:49 - services.voice - INFO - Saving chat to database
2025-05-09 04:35:49 - services.voice - INFO - Getting AI response
2025-05-09 04:36:01 - services.voice - INFO - AI response: å“ˆå“ˆï¼Œæˆ‘æ˜¯ä¸€æ¬¾AIåŠ©æ‰‹ï¼Œæ²¡æœ‰çœŸå®çš„å¹´é¾„å’Œåå­—å“¦ï½ä¸è¿‡ä½ å¯ä»¥å«æˆ‘ **DeepSeek Chat**ï¼Œæˆ–è€…éšä¾¿å–ä¸ªä½ å–œæ¬¢çš„æ˜µç§°ï¼ğŸ˜Š æˆ‘çš„çŸ¥è¯†æˆªæ­¢åˆ°2023å¹´12æœˆï¼Œæ‰€ä»¥â€œå¹´é¾„â€å¤§æ¦‚å¯ä»¥ç®—åˆ°é‚£æ—¶å€™ï½æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—ï¼Ÿ
2025-05-09 04:36:01 - services.voice - INFO - Saving AI response to database
2025-05-09 04:36:01 - services.voice - INFO - Request parameters: {'model': 'FunAudioLLM/CosyVoice2-0.5B', 'voice': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'input': 'å“ˆå“ˆï¼Œæˆ‘æ˜¯ä¸€æ¬¾AIåŠ©æ‰‹ï¼Œæ²¡æœ‰çœŸå®çš„å¹´é¾„å’Œåå­—å“¦ï½ä¸è¿‡ä½ å¯ä»¥å«æˆ‘ **DeepSeek Chat**ï¼Œæˆ–è€…éšä¾¿å–ä¸ªä½ å–œæ¬¢çš„æ˜µç§°ï¼ğŸ˜Š æˆ‘çš„çŸ¥è¯†æˆªæ­¢åˆ°2023å¹´12æœˆï¼Œæ‰€ä»¥â€œå¹´é¾„â€å¤§æ¦‚å¯ä»¥ç®—åˆ°é‚£æ—¶å€™ï½æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—ï¼Ÿ', 'response_format': 'mp3'}
2025-05-09 04:36:01 - services.voice - INFO - Making direct API call with httpx...
2025-05-09 04:36:01 - services.voice - INFO - Request URL: https://api.siliconflow.cn/v1/audio/speech
2025-05-09 04:36:01 - services.voice - INFO - Request Headers: {'Authorization': 'Bearer sk-swldh...'}
2025-05-09 04:36:01 - services.voice - INFO - Request Body: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "å“ˆå“ˆï¼Œæˆ‘æ˜¯ä¸€æ¬¾AIåŠ©æ‰‹ï¼Œæ²¡æœ‰çœŸå®çš„å¹´é¾„å’Œåå­—å“¦ï½ä¸è¿‡ä½ å¯ä»¥å«æˆ‘ **DeepSeek Chat**ï¼Œæˆ–è€…éšä¾¿å–ä¸ªä½ å–œæ¬¢çš„æ˜µç§°ï¼ğŸ˜Š æˆ‘çš„çŸ¥è¯†æˆªæ­¢åˆ°2023å¹´12æœˆï¼Œæ‰€ä»¥â€œå¹´é¾„â€å¤§æ¦‚å¯ä»¥ç®—åˆ°é‚£æ—¶å€™ï½æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—ï¼Ÿ", "response_format": "mp3"}
2025-05-09 04:36:03 - services.voice - INFO - Response Status Code: 500
2025-05-09 04:36:03 - services.voice - INFO - Response Headers: {'date': 'Thu, 08 May 2025 20:36:04 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 04:36:03 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 04:36:03 - services.voice - ERROR - Error Code: 50500
2025-05-09 04:36:03 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 04:36:03 - services.voice - ERROR - Error Data: None
2025-05-09 04:36:03 - services.voice - ERROR - Unexpected error during API call: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 279, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:36:03 - services.voice - ERROR - Error during speech generation: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:36:03 - services.voice - ERROR - HTTP Exception in generate_audio: 500: è¯­éŸ³ç”Ÿæˆå¤±è´¥: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:38:50 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:38:56 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:38:56 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:38:58 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:38:58 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:39:03 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:39:05 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:39:24 - services.voice - INFO - Starting audio generation for ID: 5
2025-05-09 04:39:24 - services.voice - INFO - Digital human info: {'id': 5, 'name': 'å°ä¸½', 'gender': 'å¥³', 'age': 18, 'phone': '15626273815', 'description': '1', 'referenceAudio': 'http://localhost:8000/static/audio/ref_ca23ad5a-b396-4c16-8bb5-2d568eb2049b_1746729875.mp3', 'trainingAudio': 'http://localhost:8000/static/audio/train_30059ed1-53a8-4b4e-a49b-27bf185e4470_1746729873.mp3', 'avatar': 'http://localhost:8000/static/uploads/avatars/f56f55c1-a2d3-4263-88b9-318cc76f89ab_1746729871.png', 'video_path': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'patient_info_path': None, 'created_at': datetime.datetime(2025, 5, 9, 2, 44, 38), 'user_id': 2, 'voice_path': None}
2025-05-09 04:39:24 - services.voice - INFO - Video path: speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc
2025-05-09 04:39:24 - services.voice - INFO - Video path length: 43
2025-05-09 04:39:24 - services.voice - INFO - Video path format check: True
2025-05-09 04:39:24 - services.voice - INFO - Transcribing audio file: http://localhost:8000/static/audio/record_cfc37d65-e157-4669-a984-d58aa8d5f0bd_1746736764.wav
2025-05-09 04:39:24 - services.voice - INFO - Starting audio transcription for file: http://localhost:8000/static/audio/record_cfc37d65-e157-4669-a984-d58aa8d5f0bd_1746736764.wav
2025-05-09 04:39:28 - services.voice - WARNING - Failed to delete temporary file D:\PyCharm Project\CCF\app_latest\static\temp\temp_7150fd79-8e05-442c-bd1d-bba5fc5957e4.wav: [WinError 32] å¦ä¸€ä¸ªç¨‹åºæ­£åœ¨ä½¿ç”¨æ­¤æ–‡ä»¶ï¼Œè¿›ç¨‹æ— æ³•è®¿é—®ã€‚: 'D:\\PyCharm Project\\CCF\\app_latest\\static\\temp\\temp_7150fd79-8e05-442c-bd1d-bba5fc5957e4.wav'
2025-05-09 04:39:28 - services.voice - INFO - Transcription completed: ä½  ä»Šå¹´ å‡ å² äº†
2025-05-09 04:39:28 - services.voice - INFO - Transcribed text: ä½  ä»Šå¹´ å‡ å² äº†
2025-05-09 04:39:28 - services.voice - INFO - Saving chat to database
2025-05-09 04:39:28 - services.voice - INFO - Getting AI response
2025-05-09 04:39:37 - services.voice - INFO - AI response: æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæ²¡æœ‰å®é™…çš„å¹´é¾„æˆ–ç”Ÿæ—¥ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ å¥½å¥‡æˆ‘çš„â€œæŠ€æœ¯å¹´é¾„â€â€”â€”æˆ‘çš„çŸ¥è¯†åº“æœ€æ–°æ›´æ–°æ˜¯åœ¨2024å¹´7æœˆï¼Œä½ å¯ä»¥ç†è§£ä¸ºæˆ‘çš„â€œçŸ¥è¯†â€åœç•™åœ¨é‚£ä¸ªæ—¶é—´ç‚¹ã€‚ğŸ˜Š 

éœ€è¦å¸®å¿™è§£ç­”å…¶ä»–é—®é¢˜å—ï¼Ÿ
2025-05-09 04:39:37 - services.voice - INFO - Saving AI response to database
2025-05-09 04:39:37 - services.voice - INFO - Original text length: 96
2025-05-09 04:39:37 - services.voice - INFO - Original text: æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæ²¡æœ‰å®é™…çš„å¹´é¾„æˆ–ç”Ÿæ—¥ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ å¥½å¥‡æˆ‘çš„â€œæŠ€æœ¯å¹´é¾„â€â€”â€”æˆ‘çš„çŸ¥è¯†åº“æœ€æ–°æ›´æ–°æ˜¯åœ¨2024å¹´7æœˆï¼Œä½ å¯ä»¥ç†è§£ä¸ºæˆ‘çš„â€œçŸ¥è¯†â€åœç•™åœ¨é‚£ä¸ªæ—¶é—´ç‚¹ã€‚ğŸ˜Š 

éœ€è¦å¸®å¿™è§£ç­”å…¶ä»–é—®é¢˜å—ï¼Ÿ
2025-05-09 04:39:37 - services.voice - INFO - After removing markdown: æˆ‘æ˜¯ä¸€ä¸ªäººå·¥æ™ºèƒ½åŠ©æ‰‹ï¼Œæ²¡æœ‰å®é™…çš„å¹´é¾„æˆ–ç”Ÿæ—¥ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ å¥½å¥‡æˆ‘çš„â€œæŠ€æœ¯å¹´é¾„â€â€”â€”æˆ‘çš„çŸ¥è¯†åº“æœ€æ–°æ›´æ–°æ˜¯åœ¨2024å¹´7æœˆï¼Œä½ å¯ä»¥ç†è§£ä¸ºæˆ‘çš„â€œçŸ¥è¯†â€åœç•™åœ¨é‚£ä¸ªæ—¶é—´ç‚¹ã€‚ğŸ˜Š 

éœ€è¦å¸®å¿™è§£ç­”å…¶ä»–é—®é¢˜å—ï¼Ÿ
2025-05-09 04:39:37 - services.voice - INFO - After removing emoji: â€œâ€â€”â€”20247â€œâ€ 


2025-05-09 04:39:37 - services.voice - INFO - Final processed text length: 11
2025-05-09 04:39:37 - services.voice - INFO - Final processed text: â€œâ€â€”â€”20247â€œâ€
2025-05-09 04:39:37 - services.voice - INFO - Processed text for TTS: â€œâ€â€”â€”20247â€œâ€
2025-05-09 04:39:37 - services.voice - INFO - Request parameters: {'model': 'FunAudioLLM/CosyVoice2-0.5B', 'voice': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'input': 'â€œâ€â€”â€”20247â€œâ€', 'response_format': 'mp3'}
2025-05-09 04:39:37 - services.voice - INFO - Making direct API call with httpx...
2025-05-09 04:39:37 - services.voice - INFO - Request URL: https://api.siliconflow.cn/v1/audio/speech
2025-05-09 04:39:37 - services.voice - INFO - Request Headers: {'Authorization': 'Bearer sk-swldh...'}
2025-05-09 04:39:37 - services.voice - INFO - Request Body: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "â€œâ€â€”â€”20247â€œâ€", "response_format": "mp3"}
2025-05-09 04:39:39 - services.voice - INFO - Response Status Code: 500
2025-05-09 04:39:39 - services.voice - INFO - Response Headers: {'date': 'Thu, 08 May 2025 20:39:40 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 04:39:39 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 04:39:39 - services.voice - ERROR - Error Code: 50500
2025-05-09 04:39:39 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 04:39:39 - services.voice - ERROR - Error Data: None
2025-05-09 04:39:39 - services.voice - INFO - Retrying with simplified text...
2025-05-09 04:39:40 - services.voice - ERROR - Unexpected error during API call: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 298, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:39:40 - services.voice - ERROR - Error during speech generation: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:39:40 - services.voice - ERROR - HTTP Exception in generate_audio: 500: è¯­éŸ³ç”Ÿæˆå¤±è´¥: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:41:57 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:42:16 - services.voice - INFO - Starting audio generation for ID: 5
2025-05-09 04:42:16 - services.voice - INFO - Digital human info: {'id': 5, 'name': 'å°ä¸½', 'gender': 'å¥³', 'age': 18, 'phone': '15626273815', 'description': '1', 'referenceAudio': 'http://localhost:8000/static/audio/ref_ca23ad5a-b396-4c16-8bb5-2d568eb2049b_1746729875.mp3', 'trainingAudio': 'http://localhost:8000/static/audio/train_30059ed1-53a8-4b4e-a49b-27bf185e4470_1746729873.mp3', 'avatar': 'http://localhost:8000/static/uploads/avatars/f56f55c1-a2d3-4263-88b9-318cc76f89ab_1746729871.png', 'video_path': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'patient_info_path': None, 'created_at': datetime.datetime(2025, 5, 9, 2, 44, 38), 'user_id': 2, 'voice_path': None}
2025-05-09 04:42:16 - services.voice - INFO - Video path: speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc
2025-05-09 04:42:16 - services.voice - INFO - Video path length: 43
2025-05-09 04:42:16 - services.voice - INFO - Video path format check: True
2025-05-09 04:42:16 - services.voice - INFO - Transcribing audio file: http://localhost:8000/static/audio/record_d4d78bdc-a70c-4e8c-8f54-6307c184a1aa_1746736936.wav
2025-05-09 04:42:16 - services.voice - INFO - Starting audio transcription for file: http://localhost:8000/static/audio/record_d4d78bdc-a70c-4e8c-8f54-6307c184a1aa_1746736936.wav
2025-05-09 04:42:20 - services.voice - WARNING - Failed to delete temporary file D:\PyCharm Project\CCF\app_latest\static\temp\temp_b9add680-1430-4df9-92d5-8b9ab2d514a2.wav: [WinError 32] å¦ä¸€ä¸ªç¨‹åºæ­£åœ¨ä½¿ç”¨æ­¤æ–‡ä»¶ï¼Œè¿›ç¨‹æ— æ³•è®¿é—®ã€‚: 'D:\\PyCharm Project\\CCF\\app_latest\\static\\temp\\temp_b9add680-1430-4df9-92d5-8b9ab2d514a2.wav'
2025-05-09 04:42:20 - services.voice - INFO - Transcription completed: ä½  ä»Šå¹´ å‡ å² äº† ä½  å« ä»€ä¹ˆ åå­—
2025-05-09 04:42:20 - services.voice - INFO - Transcribed text: ä½  ä»Šå¹´ å‡ å² äº† ä½  å« ä»€ä¹ˆ åå­—
2025-05-09 04:42:20 - services.voice - INFO - Saving chat to database
2025-05-09 04:42:20 - services.voice - INFO - Getting AI response
2025-05-09 04:42:27 - services.voice - INFO - AI response: æˆ‘æ˜¯ **DeepSeek Chat**ï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸åˆ›é€ ã€‚è™½ç„¶æˆ‘æ²¡æœ‰å¹´é¾„ï¼Œä½†æˆ‘çš„çŸ¥è¯†æˆªæ­¢åˆ° **2024å¹´7æœˆ**ï¼Œä½ å¯ä»¥æŠŠæˆ‘å½“ä½œä¸€ä¸ªæ°¸è¿œå……æ»¡æ´»åŠ›çš„AIåŠ©æ‰‹ï¼ğŸ˜Š  

è‡³äºåå­—ï¼Œä½ å¯ä»¥å«æˆ‘ **DeepSeek**ï¼Œæˆ–è€…ç»™æˆ‘å–ä¸ªä½ å–œæ¬¢çš„æ˜µç§°ï½  

æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—ï¼Ÿâœ¨
2025-05-09 04:42:27 - services.voice - INFO - Saving AI response to database
2025-05-09 04:42:27 - services.voice - INFO - Original text length: 139
2025-05-09 04:42:27 - services.voice - INFO - Original text: æˆ‘æ˜¯ **DeepSeek Chat**ï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸åˆ›é€ ã€‚è™½ç„¶æˆ‘æ²¡æœ‰å¹´é¾„ï¼Œä½†æˆ‘çš„çŸ¥è¯†æˆªæ­¢åˆ° **2024å¹´7æœˆ**ï¼Œä½ å¯ä»¥æŠŠæˆ‘å½“ä½œä¸€ä¸ªæ°¸è¿œå……æ»¡æ´»åŠ›çš„AIåŠ©æ‰‹ï¼ğŸ˜Š  

è‡³äºåå­—ï¼Œä½ å¯ä»¥å«æˆ‘ **DeepSeek**ï¼Œæˆ–è€…ç»™æˆ‘å–ä¸ªä½ å–œæ¬¢çš„æ˜µç§°ï½  

æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—ï¼Ÿâœ¨
2025-05-09 04:42:27 - services.voice - INFO - After removing markdown: æˆ‘æ˜¯ DeepSeek Chatï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸åˆ›é€ ã€‚è™½ç„¶æˆ‘æ²¡æœ‰å¹´é¾„ï¼Œä½†æˆ‘çš„çŸ¥è¯†æˆªæ­¢åˆ° 2024å¹´7æœˆï¼Œä½ å¯ä»¥æŠŠæˆ‘å½“ä½œä¸€ä¸ªæ°¸è¿œå……æ»¡æ´»åŠ›çš„AIåŠ©æ‰‹ï¼ğŸ˜Š  

è‡³äºåå­—ï¼Œä½ å¯ä»¥å«æˆ‘ DeepSeekï¼Œæˆ–è€…ç»™æˆ‘å–ä¸ªä½ å–œæ¬¢çš„æ˜µç§°ï½  

æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ çš„å—ï¼Ÿâœ¨
2025-05-09 04:42:27 - services.voice - INFO - After removing emoji:  DeepSeek Chat 20247AI  

 DeepSeek  


2025-05-09 04:42:27 - services.voice - INFO - Final processed text length: 30
2025-05-09 04:42:27 - services.voice - INFO - Final processed text: DeepSeek Chat 20247AI DeepSeek
2025-05-09 04:42:27 - services.voice - INFO - Processed text for TTS: DeepSeek Chat 20247AI DeepSeek
2025-05-09 04:42:27 - services.voice - INFO - Request parameters: {'model': 'FunAudioLLM/CosyVoice2-0.5B', 'voice': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'input': 'DeepSeek Chat 20247AI DeepSeek', 'response_format': 'mp3'}
2025-05-09 04:42:27 - services.voice - INFO - Making direct API call with httpx...
2025-05-09 04:42:27 - services.voice - INFO - Request URL: https://api.siliconflow.cn/v1/audio/speech
2025-05-09 04:42:27 - services.voice - INFO - Request Headers: {'Authorization': 'Bearer sk-swldh...'}
2025-05-09 04:42:27 - services.voice - INFO - Request Body: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "DeepSeek Chat 20247AI DeepSeek", "response_format": "mp3"}
2025-05-09 04:42:29 - services.voice - INFO - Response Status Code: 500
2025-05-09 04:42:29 - services.voice - INFO - Response Headers: {'date': 'Thu, 08 May 2025 20:42:29 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 04:42:29 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 04:42:29 - services.voice - ERROR - Error Code: 50500
2025-05-09 04:42:29 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 04:42:29 - services.voice - ERROR - Error Data: None
2025-05-09 04:42:29 - services.voice - INFO - Retrying with simplified text...
2025-05-09 04:42:30 - services.voice - ERROR - Unexpected error during API call: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 298, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:42:30 - services.voice - ERROR - Error during speech generation: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:42:30 - services.voice - ERROR - HTTP Exception in generate_audio: 500: è¯­éŸ³ç”Ÿæˆå¤±è´¥: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:43:39 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:43:39 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:43:41 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:43:44 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:43:45 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 04:44:03 - services.voice - INFO - Starting audio generation for ID: 5
2025-05-09 04:44:03 - services.voice - INFO - Digital human info: {'id': 5, 'name': 'å°ä¸½', 'gender': 'å¥³', 'age': 18, 'phone': '15626273815', 'description': '1', 'referenceAudio': 'http://localhost:8000/static/audio/ref_ca23ad5a-b396-4c16-8bb5-2d568eb2049b_1746729875.mp3', 'trainingAudio': 'http://localhost:8000/static/audio/train_30059ed1-53a8-4b4e-a49b-27bf185e4470_1746729873.mp3', 'avatar': 'http://localhost:8000/static/uploads/avatars/f56f55c1-a2d3-4263-88b9-318cc76f89ab_1746729871.png', 'video_path': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'patient_info_path': None, 'created_at': datetime.datetime(2025, 5, 9, 2, 44, 38), 'user_id': 2, 'voice_path': None}
2025-05-09 04:44:03 - services.voice - INFO - Video path: speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc
2025-05-09 04:44:03 - services.voice - INFO - Video path length: 43
2025-05-09 04:44:03 - services.voice - INFO - Video path format check: True
2025-05-09 04:44:03 - services.voice - INFO - Transcribing audio file: http://localhost:8000/static/audio/record_8fcbba3b-9066-40aa-a53c-575e5f4fa46d_1746737043.wav
2025-05-09 04:44:03 - services.voice - INFO - Starting audio transcription for file: http://localhost:8000/static/audio/record_8fcbba3b-9066-40aa-a53c-575e5f4fa46d_1746737043.wav
2025-05-09 04:44:07 - services.voice - WARNING - Failed to delete temporary file D:\PyCharm Project\CCF\app_latest\static\temp\temp_cd482e3e-423b-4e63-bfe9-c1905d982680.wav: [WinError 32] å¦ä¸€ä¸ªç¨‹åºæ­£åœ¨ä½¿ç”¨æ­¤æ–‡ä»¶ï¼Œè¿›ç¨‹æ— æ³•è®¿é—®ã€‚: 'D:\\PyCharm Project\\CCF\\app_latest\\static\\temp\\temp_cd482e3e-423b-4e63-bfe9-c1905d982680.wav'
2025-05-09 04:44:07 - services.voice - INFO - Transcription completed: ä½  å« ä»€ä¹ˆ åå­— ä»Šå¹´ è®¡ç®—
2025-05-09 04:44:07 - services.voice - INFO - Transcribed text: ä½  å« ä»€ä¹ˆ åå­— ä»Šå¹´ è®¡ç®—
2025-05-09 04:44:07 - services.voice - INFO - Saving chat to database
2025-05-09 04:44:07 - services.voice - INFO - Getting AI response
2025-05-09 04:44:15 - services.voice - INFO - AI response: æˆ‘æ˜¯ **DeepSeek Chat**ï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸åˆ›é€ ã€‚ä½ å¯ä»¥å«æˆ‘ **DeepSeek** æˆ– **å°æ·±**ï¼ğŸ˜Š  

è‡³äºâ€œä»Šå¹´è®¡ç®—â€ï¼Œå¦‚æœä½ æ˜¯æƒ³é—®æˆ‘çš„çŸ¥è¯†æˆªæ­¢æ—¥æœŸï¼Œæˆ‘çš„æœ€æ–°çŸ¥è¯†æ›´æ–°åˆ° **2024å¹´7æœˆ**ã€‚ä¸è¿‡ï¼Œæˆ‘æ²¡æœ‰å¹´é¾„æ¦‚å¿µï¼Œä¹Ÿä¸ä¼šéšæ—¶é—´å¢é•¿å˜è€å“¦ï½  

æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ è®¡ç®—æˆ–è§£ç­”çš„å—ï¼ŸğŸ“ŠğŸ”¢
2025-05-09 04:44:15 - services.voice - INFO - Saving AI response to database
2025-05-09 04:44:15 - services.voice - INFO - Original text length: 155
2025-05-09 04:44:15 - services.voice - INFO - Original text: æˆ‘æ˜¯ **DeepSeek Chat**ï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸åˆ›é€ ã€‚ä½ å¯ä»¥å«æˆ‘ **DeepSeek** æˆ– **å°æ·±**ï¼ğŸ˜Š  

è‡³äºâ€œä»Šå¹´è®¡ç®—â€ï¼Œå¦‚æœä½ æ˜¯æƒ³é—®æˆ‘çš„çŸ¥è¯†æˆªæ­¢æ—¥æœŸï¼Œæˆ‘çš„æœ€æ–°çŸ¥è¯†æ›´æ–°åˆ° **2024å¹´7æœˆ**ã€‚ä¸è¿‡ï¼Œæˆ‘æ²¡æœ‰å¹´é¾„æ¦‚å¿µï¼Œä¹Ÿä¸ä¼šéšæ—¶é—´å¢é•¿å˜è€å“¦ï½  

æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ è®¡ç®—æˆ–è§£ç­”çš„å—ï¼ŸğŸ“ŠğŸ”¢
2025-05-09 04:44:15 - services.voice - INFO - After removing markdown: æˆ‘æ˜¯ DeepSeek Chatï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸åˆ›é€ ã€‚ä½ å¯ä»¥å«æˆ‘ DeepSeek æˆ– å°æ·±ï¼ğŸ˜Š  

è‡³äºâ€œä»Šå¹´è®¡ç®—â€ï¼Œå¦‚æœä½ æ˜¯æƒ³é—®æˆ‘çš„çŸ¥è¯†æˆªæ­¢æ—¥æœŸï¼Œæˆ‘çš„æœ€æ–°çŸ¥è¯†æ›´æ–°åˆ° 2024å¹´7æœˆã€‚ä¸è¿‡ï¼Œæˆ‘æ²¡æœ‰å¹´é¾„æ¦‚å¿µï¼Œä¹Ÿä¸ä¼šéšæ—¶é—´å¢é•¿å˜è€å“¦ï½  

æœ‰ä»€ä¹ˆæˆ‘å¯ä»¥å¸®ä½ è®¡ç®—æˆ–è§£ç­”çš„å—ï¼ŸğŸ“ŠğŸ”¢
2025-05-09 04:44:15 - services.voice - INFO - After removing emoji:  DeepSeek Chat DeepSeek    

â€œâ€ 20247  


2025-05-09 04:44:15 - services.voice - INFO - Final processed text length: 31
2025-05-09 04:44:15 - services.voice - INFO - Final processed text: DeepSeek Chat DeepSeek â€œâ€ 20247
2025-05-09 04:44:15 - services.voice - INFO - Processed text for TTS: DeepSeek Chat DeepSeek â€œâ€ 20247
2025-05-09 04:44:15 - services.voice - INFO - Request parameters: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "DeepSeek Chat DeepSeek â€œâ€ 20247", "response_format": "mp3"}
2025-05-09 04:44:15 - services.voice - INFO - Making direct API call with httpx...
2025-05-09 04:44:15 - services.voice - INFO - Request URL: https://api.siliconflow.cn/v1/audio/speech
2025-05-09 04:44:15 - services.voice - INFO - Request Headers: {'Authorization': 'Bearer sk-swldh...'}
2025-05-09 04:44:15 - services.voice - INFO - Request Body: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "DeepSeek Chat DeepSeek â€œâ€ 20247", "response_format": "mp3"}
2025-05-09 04:44:17 - services.voice - INFO - Response Status Code: 500
2025-05-09 04:44:17 - services.voice - INFO - Response Headers: {'date': 'Thu, 08 May 2025 20:44:17 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 04:44:17 - services.voice - INFO - Response Body: {"code":50500,"message":"Request processing has failed due to some unknown error.","data":null}
2025-05-09 04:44:17 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 04:44:17 - services.voice - ERROR - Error Code: 50500
2025-05-09 04:44:17 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 04:44:17 - services.voice - ERROR - Error Data: None
2025-05-09 04:44:17 - services.voice - INFO - Retrying with simplified text...
2025-05-09 04:44:17 - services.voice - INFO - Retry request parameters: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "DeepSeek Chat DeepSeek â€œâ€ 20247", "response_format": "mp3"}
2025-05-09 04:44:18 - services.voice - INFO - Retry Response Status Code: 500
2025-05-09 04:44:18 - services.voice - INFO - Retry Response Headers: {'date': 'Thu, 08 May 2025 20:44:19 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 04:44:18 - services.voice - INFO - Retry Response Body: {"code":50500,"message":"Request processing has failed due to some unknown error.","data":null}
2025-05-09 04:44:18 - services.voice - ERROR - Retry API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 04:44:18 - services.voice - ERROR - Unexpected error during API call: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 308, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:44:18 - services.voice - ERROR - Error during speech generation: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 04:44:18 - services.voice - ERROR - HTTP Exception in generate_audio: 500: è¯­éŸ³ç”Ÿæˆå¤±è´¥: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 08:14:14 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 08:14:15 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 08:17:44 - services.voice - INFO - Starting audio generation for ID: 5
2025-05-09 08:17:44 - services.voice - INFO - Digital human info: {'id': 5, 'name': 'å°ä¸½', 'gender': 'å¥³', 'age': 18, 'phone': '15626273815', 'description': '1', 'referenceAudio': 'http://localhost:8000/static/audio/ref_ca23ad5a-b396-4c16-8bb5-2d568eb2049b_1746729875.mp3', 'trainingAudio': 'http://localhost:8000/static/audio/train_30059ed1-53a8-4b4e-a49b-27bf185e4470_1746729873.mp3', 'avatar': 'http://localhost:8000/static/uploads/avatars/f56f55c1-a2d3-4263-88b9-318cc76f89ab_1746729871.png', 'video_path': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'patient_info_path': None, 'created_at': datetime.datetime(2025, 5, 9, 2, 44, 38), 'user_id': 2, 'voice_path': None}
2025-05-09 08:17:44 - services.voice - INFO - Video path: speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc
2025-05-09 08:17:44 - services.voice - INFO - Video path length: 43
2025-05-09 08:17:44 - services.voice - INFO - Video path format check: True
2025-05-09 08:17:44 - services.voice - INFO - Transcribing audio file: http://localhost:8000/static/audio/record_24579bd8-0360-4826-ac3c-455b5180d9ee_1746749864.wav
2025-05-09 08:17:44 - services.voice - INFO - Starting audio transcription for file: http://localhost:8000/static/audio/record_24579bd8-0360-4826-ac3c-455b5180d9ee_1746749864.wav
2025-05-09 08:17:47 - services.voice - WARNING - Failed to delete temporary file D:\PyCharm Project\CCF\app_latest\static\temp\temp_fd96db86-6291-4b68-a885-3b66358b64f0.wav: [WinError 32] å¦ä¸€ä¸ªç¨‹åºæ­£åœ¨ä½¿ç”¨æ­¤æ–‡ä»¶ï¼Œè¿›ç¨‹æ— æ³•è®¿é—®ã€‚: 'D:\\PyCharm Project\\CCF\\app_latest\\static\\temp\\temp_fd96db86-6291-4b68-a885-3b66358b64f0.wav'
2025-05-09 08:17:47 - services.voice - INFO - Transcription completed: ä½  å« ä»€ä¹ˆ åå­— å‡ å¹´ å¹´çº§ äº†
2025-05-09 08:17:47 - services.voice - INFO - Transcribed text: ä½  å« ä»€ä¹ˆ åå­— å‡ å¹´ å¹´çº§ äº†
2025-05-09 08:17:47 - services.voice - INFO - Saving chat to database
2025-05-09 08:17:47 - services.voice - INFO - Getting AI response
2025-05-09 08:17:54 - services.voice - INFO - AI response: æˆ‘çš„åå­—æ˜¯ **DeepSeek Chat**ï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸åˆ›é€ ï¼ğŸ˜Š  

è‡³äºâ€œå‡ å¹´å¹´çº§â€ï¼Œæˆ‘çŒœä½ å¯èƒ½æƒ³é—®æˆ‘çš„â€œå¹´é¾„â€æˆ–â€œç‰ˆæœ¬â€ï¼Ÿæˆ‘æ˜¯ **DeepSeek-V3**ï¼ŒçŸ¥è¯†æˆªæ­¢åˆ° **2024å¹´7æœˆ**ï¼Œä½†ä¸åƒäººç±»é‚£æ ·æœ‰å¹´çº§æˆ–å¹´é¾„çš„æ¦‚å¿µå“¦ï½  

å¦‚æœä½ æ˜¯æƒ³é—®è‡ªå·±çš„å¹´çº§ï¼ˆæ¯”å¦‚å°å­¦ã€åˆä¸­ã€é«˜ä¸­ç­‰ï¼‰ï¼Œå¯ä»¥å‘Šè¯‰æˆ‘ï¼Œæˆ‘å¯ä»¥å¸®ä½ è§£ç­”å­¦ä¹ ç›¸å…³çš„é—®é¢˜ï¼ğŸ“šâœ¨
2025-05-09 08:17:54 - services.voice - INFO - Saving AI response to database
2025-05-09 08:17:54 - services.voice - INFO - Original text length: 174
2025-05-09 08:17:54 - services.voice - INFO - Original text: æˆ‘çš„åå­—æ˜¯ **DeepSeek Chat**ï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸åˆ›é€ ï¼ğŸ˜Š  

è‡³äºâ€œå‡ å¹´å¹´çº§â€ï¼Œæˆ‘çŒœä½ å¯èƒ½æƒ³é—®æˆ‘çš„â€œå¹´é¾„â€æˆ–â€œç‰ˆæœ¬â€ï¼Ÿæˆ‘æ˜¯ **DeepSeek-V3**ï¼ŒçŸ¥è¯†æˆªæ­¢åˆ° **2024å¹´7æœˆ**ï¼Œä½†ä¸åƒäººç±»é‚£æ ·æœ‰å¹´çº§æˆ–å¹´é¾„çš„æ¦‚å¿µå“¦ï½  

å¦‚æœä½ æ˜¯æƒ³é—®è‡ªå·±çš„å¹´çº§ï¼ˆæ¯”å¦‚å°å­¦ã€åˆä¸­ã€é«˜ä¸­ç­‰ï¼‰ï¼Œå¯ä»¥å‘Šè¯‰æˆ‘ï¼Œæˆ‘å¯ä»¥å¸®ä½ è§£ç­”å­¦ä¹ ç›¸å…³çš„é—®é¢˜ï¼ğŸ“šâœ¨
2025-05-09 08:17:54 - services.voice - INFO - After removing markdown: æˆ‘çš„åå­—æ˜¯ DeepSeek Chatï¼Œç”±æ·±åº¦æ±‚ç´¢å…¬å¸åˆ›é€ ï¼ğŸ˜Š  

è‡³äºâ€œå‡ å¹´å¹´çº§â€ï¼Œæˆ‘çŒœä½ å¯èƒ½æƒ³é—®æˆ‘çš„â€œå¹´é¾„â€æˆ–â€œç‰ˆæœ¬â€ï¼Ÿæˆ‘æ˜¯ DeepSeek-V3ï¼ŒçŸ¥è¯†æˆªæ­¢åˆ° 2024å¹´7æœˆï¼Œä½†ä¸åƒäººç±»é‚£æ ·æœ‰å¹´çº§æˆ–å¹´é¾„çš„æ¦‚å¿µå“¦ï½  

å¦‚æœä½ æ˜¯æƒ³é—®è‡ªå·±çš„å¹´çº§ï¼ˆæ¯”å¦‚å°å­¦ã€åˆä¸­ã€é«˜ä¸­ç­‰ï¼‰ï¼Œå¯ä»¥å‘Šè¯‰æˆ‘ï¼Œæˆ‘å¯ä»¥å¸®ä½ è§£ç­”å­¦ä¹ ç›¸å…³çš„é—®é¢˜ï¼ğŸ“šâœ¨
2025-05-09 08:17:54 - services.voice - INFO - After removing emoji:  DeepSeek Chat  

â€œâ€â€œâ€â€œâ€ DeepSeek-V3 20247  


2025-05-09 08:17:54 - services.voice - INFO - Final processed text length: 31
2025-05-09 08:17:54 - services.voice - INFO - Final processed text: DeepSeek Chat  DeepSeekV3 20247
2025-05-09 08:17:54 - services.voice - INFO - Processed text for TTS: DeepSeek Chat  DeepSeekV3 20247
2025-05-09 08:17:54 - services.voice - INFO - Request parameters: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "DeepSeek Chat  DeepSeekV3 20247", "response_format": "mp3"}
2025-05-09 08:17:54 - services.voice - INFO - Making direct API call with httpx...
2025-05-09 08:17:54 - services.voice - INFO - Request URL: https://api.siliconflow.cn/v1/audio/speech
2025-05-09 08:17:54 - services.voice - INFO - Request Headers: {'Authorization': 'Bearer sk-swldh...'}
2025-05-09 08:17:54 - services.voice - INFO - Request Body: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "DeepSeek Chat  DeepSeekV3 20247", "response_format": "mp3"}
2025-05-09 08:17:56 - services.voice - INFO - Response Status Code: 500
2025-05-09 08:17:56 - services.voice - INFO - Response Headers: {'date': 'Fri, 09 May 2025 00:17:56 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 08:17:56 - services.voice - INFO - Response Body: {"code":50500,"message":"Request processing has failed due to some unknown error.","data":null}
2025-05-09 08:17:56 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 08:17:56 - services.voice - ERROR - Error Code: 50500
2025-05-09 08:17:56 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 08:17:56 - services.voice - ERROR - Error Data: None
2025-05-09 08:17:56 - services.voice - INFO - Retrying with simplified text...
2025-05-09 08:17:56 - services.voice - INFO - Simplified text: DeepSeek Chat  DeepSeekV3 20247
2025-05-09 08:17:56 - services.voice - INFO - Retry request parameters: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": "DeepSeek Chat  DeepSeekV3 20247", "response_format": "mp3"}
2025-05-09 08:17:57 - services.voice - INFO - Retry Response Status Code: 500
2025-05-09 08:17:57 - services.voice - INFO - Retry Response Headers: {'date': 'Fri, 09 May 2025 00:17:57 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 08:17:57 - services.voice - INFO - Retry Response Body: {"code":50500,"message":"Request processing has failed due to some unknown error.","data":null}
2025-05-09 08:17:57 - services.voice - ERROR - Retry API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 08:17:57 - services.voice - ERROR - Unexpected error during API call: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
Traceback (most recent call last):
  File "D:\PyCharm Project\CCF\app_latest\services\voice.py", line 308, in generate_audio
    raise HTTPException(
fastapi.exceptions.HTTPException: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 08:17:57 - services.voice - ERROR - Error during speech generation: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 08:17:57 - services.voice - ERROR - HTTP Exception in generate_audio: 500: è¯­éŸ³ç”Ÿæˆå¤±è´¥: 500: APIè°ƒç”¨å¤±è´¥: 500: API error: {'code': 50500, 'message': 'Request processing has failed due to some unknown error.', 'data': None}
2025-05-09 08:24:14 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 08:33:04 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 08:33:32 - services.voice - INFO - Starting audio generation for ID: 5
2025-05-09 08:33:32 - services.voice - INFO - Digital human info: {'id': 5, 'name': 'å°ä¸½', 'gender': 'å¥³', 'age': 18, 'phone': '15626273815', 'description': '1', 'referenceAudio': 'http://localhost:8000/static/audio/ref_ca23ad5a-b396-4c16-8bb5-2d568eb2049b_1746729875.mp3', 'trainingAudio': 'http://localhost:8000/static/audio/train_30059ed1-53a8-4b4e-a49b-27bf185e4470_1746729873.mp3', 'avatar': 'http://localhost:8000/static/uploads/avatars/f56f55c1-a2d3-4263-88b9-318cc76f89ab_1746729871.png', 'video_path': 'speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc', 'patient_info_path': None, 'created_at': datetime.datetime(2025, 5, 9, 2, 44, 38), 'user_id': 2, 'voice_path': None}
2025-05-09 08:33:32 - services.voice - INFO - Video path: speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc
2025-05-09 08:33:32 - services.voice - INFO - Video path length: 43
2025-05-09 08:33:32 - services.voice - INFO - Video path format check: True
2025-05-09 08:33:32 - services.voice - INFO - Transcribing audio file: http://localhost:8000/static/audio/record_97acd089-a013-4b5c-bdde-8c68b478b364_1746750812.wav
2025-05-09 08:33:32 - services.voice - INFO - Starting audio transcription for file: http://localhost:8000/static/audio/record_97acd089-a013-4b5c-bdde-8c68b478b364_1746750812.wav
2025-05-09 08:33:36 - services.voice - WARNING - Failed to delete temporary file D:\PyCharm Project\CCF\app_latest\static\temp\temp_9e2b95f8-0472-43eb-91f3-0c9241cf1aa4.wav: [WinError 32] å¦ä¸€ä¸ªç¨‹åºæ­£åœ¨ä½¿ç”¨æ­¤æ–‡ä»¶ï¼Œè¿›ç¨‹æ— æ³•è®¿é—®ã€‚: 'D:\\PyCharm Project\\CCF\\app_latest\\static\\temp\\temp_9e2b95f8-0472-43eb-91f3-0c9241cf1aa4.wav'
2025-05-09 08:33:36 - services.voice - INFO - Transcription completed: ä»Šå¤© å¹¿å· å¤©æ°” æ€ä¹ˆæ ·
2025-05-09 08:33:36 - services.voice - INFO - Transcribed text: ä»Šå¤© å¹¿å· å¤©æ°” æ€ä¹ˆæ ·
2025-05-09 08:33:36 - services.voice - INFO - Saving chat to database
2025-05-09 08:33:36 - services.voice - INFO - Getting AI response
2025-05-09 08:33:46 - services.voice - INFO - AI response: è¦è·å–å¹¿å·ä»Šå¤©çš„å®æ—¶å¤©æ°”ä¿¡æ¯ï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥è¯¢ï¼š

1. **å¤©æ°”é¢„æŠ¥åº”ç”¨**ï¼šæ‰“å¼€æ‰‹æœºä¸Šçš„å¤©æ°”åº”ç”¨ï¼ˆå¦‚è‹¹æœå¤©æ°”ã€å¢¨è¿¹å¤©æ°”ç­‰ï¼‰ï¼Œæœç´¢â€œå¹¿å·â€å³å¯æŸ¥çœ‹å®æ—¶å¤©æ°”ã€æ¸©åº¦ã€æ¹¿åº¦ã€é™æ°´æ¦‚ç‡ç­‰æ•°æ®ã€‚  
2. **æœç´¢å¼•æ“**ï¼šåœ¨æµè§ˆå™¨æœç´¢â€œå¹¿å·ä»Šå¤©å¤©æ°”â€ï¼Œé€šå¸¸ä¼šç›´æ¥æ˜¾ç¤ºå³æ—¶å¤©æ°”å¡ç‰‡ï¼ˆå¦‚ç™¾åº¦ã€è°·æ­Œï¼‰ã€‚  
3. **æ°”è±¡ç½‘ç«™**ï¼šè®¿é—®ä¸­å›½å¤©æ°”ç½‘ï¼ˆ[www.weather.com.cn](http://www.weather.com.cn)ï¼‰æˆ–ä¸­å¤®æ°”è±¡å°å®˜ç½‘æŸ¥è¯¢ã€‚

*ç”±äºæˆ‘æ— æ³•è·å–å®æ—¶æ•°æ®ï¼Œå»ºè®®ä½ é€šè¿‡ä¸Šè¿°æ–¹å¼æŸ¥çœ‹æœ€æ–°ä¿¡æ¯ã€‚å¦‚æœéœ€è¦å¸®åŠ©åˆ†æå¤©æ°”è¶‹åŠ¿æˆ–å‡ºè¡Œå»ºè®®ï¼Œå¯ä»¥å‘Šè¯‰æˆ‘å…·ä½“éœ€æ±‚å“¦ï¼*  

ä¾‹å¦‚ï¼šä»Šå¤©å¹¿å·å¯èƒ½æœ‰é›·é˜µé›¨ï¼ˆå‚è€ƒè¿‘æœŸæ°”å€™ï¼‰ï¼Œè®°å¾—å¸¦ä¼ğŸŒ‚ã€‚
2025-05-09 08:33:46 - services.voice - INFO - Saving AI response to database
2025-05-09 08:33:46 - services.voice - INFO - Original text length: 323
2025-05-09 08:33:46 - services.voice - INFO - Original text: è¦è·å–å¹¿å·ä»Šå¤©çš„å®æ—¶å¤©æ°”ä¿¡æ¯ï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥è¯¢ï¼š

1. **å¤©æ°”é¢„æŠ¥åº”ç”¨**ï¼šæ‰“å¼€æ‰‹æœºä¸Šçš„å¤©æ°”åº”ç”¨ï¼ˆå¦‚è‹¹æœå¤©æ°”ã€å¢¨è¿¹å¤©æ°”ç­‰ï¼‰ï¼Œæœç´¢â€œå¹¿å·â€å³å¯æŸ¥çœ‹å®æ—¶å¤©æ°”ã€æ¸©åº¦ã€æ¹¿åº¦ã€é™æ°´æ¦‚ç‡ç­‰æ•°æ®ã€‚  
2. **æœç´¢å¼•æ“**ï¼šåœ¨æµè§ˆå™¨æœç´¢â€œå¹¿å·ä»Šå¤©å¤©æ°”â€ï¼Œé€šå¸¸ä¼šç›´æ¥æ˜¾ç¤ºå³æ—¶å¤©æ°”å¡ç‰‡ï¼ˆå¦‚ç™¾åº¦ã€è°·æ­Œï¼‰ã€‚  
3. **æ°”è±¡ç½‘ç«™**ï¼šè®¿é—®ä¸­å›½å¤©æ°”ç½‘ï¼ˆ[www.weather.com.cn](http://www.weather.com.cn)ï¼‰æˆ–ä¸­å¤®æ°”è±¡å°å®˜ç½‘æŸ¥è¯¢ã€‚

*ç”±äºæˆ‘æ— æ³•è·å–å®æ—¶æ•°æ®ï¼Œå»ºè®®ä½ é€šè¿‡ä¸Šè¿°æ–¹å¼æŸ¥çœ‹æœ€æ–°ä¿¡æ¯ã€‚å¦‚æœéœ€è¦å¸®åŠ©åˆ†æå¤©æ°”è¶‹åŠ¿æˆ–å‡ºè¡Œå»ºè®®ï¼Œå¯ä»¥å‘Šè¯‰æˆ‘å…·ä½“éœ€æ±‚å“¦ï¼*  

ä¾‹å¦‚ï¼šä»Šå¤©å¹¿å·å¯èƒ½æœ‰é›·é˜µé›¨ï¼ˆå‚è€ƒè¿‘æœŸæ°”å€™ï¼‰ï¼Œè®°å¾—å¸¦ä¼ğŸŒ‚ã€‚
2025-05-09 08:33:46 - services.voice - INFO - After removing markdown: è¦è·å–å¹¿å·ä»Šå¤©çš„å®æ—¶å¤©æ°”ä¿¡æ¯ï¼Œä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼æŸ¥è¯¢ï¼š

1. å¤©æ°”é¢„æŠ¥åº”ç”¨ï¼šæ‰“å¼€æ‰‹æœºä¸Šçš„å¤©æ°”åº”ç”¨ï¼ˆå¦‚è‹¹æœå¤©æ°”ã€å¢¨è¿¹å¤©æ°”ç­‰ï¼‰ï¼Œæœç´¢â€œå¹¿å·â€å³å¯æŸ¥çœ‹å®æ—¶å¤©æ°”ã€æ¸©åº¦ã€æ¹¿åº¦ã€é™æ°´æ¦‚ç‡ç­‰æ•°æ®ã€‚  
2. æœç´¢å¼•æ“ï¼šåœ¨æµè§ˆå™¨æœç´¢â€œå¹¿å·ä»Šå¤©å¤©æ°”â€ï¼Œé€šå¸¸ä¼šç›´æ¥æ˜¾ç¤ºå³æ—¶å¤©æ°”å¡ç‰‡ï¼ˆå¦‚ç™¾åº¦ã€è°·æ­Œï¼‰ã€‚  
3. æ°”è±¡ç½‘ç«™ï¼šè®¿é—®ä¸­å›½å¤©æ°”ç½‘ï¼ˆ[www.weather.com.cn](http://www.weather.com.cn)ï¼‰æˆ–ä¸­å¤®æ°”è±¡å°å®˜ç½‘æŸ¥è¯¢ã€‚

ç”±äºæˆ‘æ— æ³•è·å–å®æ—¶æ•°æ®ï¼Œå»ºè®®ä½ é€šè¿‡ä¸Šè¿°æ–¹å¼æŸ¥çœ‹æœ€æ–°ä¿¡æ¯ã€‚å¦‚æœéœ€è¦å¸®åŠ©åˆ†æå¤©æ°”è¶‹åŠ¿æˆ–å‡ºè¡Œå»ºè®®ï¼Œå¯ä»¥å‘Šè¯‰æˆ‘å…·ä½“éœ€æ±‚å“¦ï¼  

ä¾‹å¦‚ï¼šä»Šå¤©å¹¿å·å¯èƒ½æœ‰é›·é˜µé›¨ï¼ˆå‚è€ƒè¿‘æœŸæ°”å€™ï¼‰ï¼Œè®°å¾—å¸¦ä¼ğŸŒ‚ã€‚
2025-05-09 08:33:46 - services.voice - INFO - After removing emoji: 

1. â€œâ€  
2. â€œâ€  
3. [www.weather.com.cn](http://www.weather.com.cn)

  


2025-05-09 08:33:46 - services.voice - INFO - Final processed text length: 46
2025-05-09 08:33:46 - services.voice - INFO - Final processed text: . . . www.weather.com.cnhttpwww.weather.com.cn
2025-05-09 08:33:46 - services.voice - INFO - Processed text for TTS: . . . www.weather.com.cnhttpwww.weather.com.cn
2025-05-09 08:33:46 - services.voice - INFO - Request parameters: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": ". . . www.weather.com.cnhttpwww.weather.com.cn", "response_format": "mp3"}
2025-05-09 08:33:46 - services.voice - INFO - Making direct API call with httpx...
2025-05-09 08:33:46 - services.voice - INFO - Request URL: https://api.siliconflow.cn/v1/audio/speech
2025-05-09 08:33:46 - services.voice - INFO - Request Headers: {'Authorization': 'Bearer sk-swldh...'}
2025-05-09 08:33:46 - services.voice - INFO - Request Body: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": ". . . www.weather.com.cnhttpwww.weather.com.cn", "response_format": "mp3"}
2025-05-09 08:33:48 - services.voice - INFO - Response Status Code: 500
2025-05-09 08:33:48 - services.voice - INFO - Response Headers: {'date': 'Fri, 09 May 2025 00:33:48 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 08:33:48 - services.voice - INFO - Response Body: {"code":50500,"message":"Request processing has failed due to some unknown error.","data":null}
2025-05-09 08:33:48 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 08:33:48 - services.voice - ERROR - Error Code: 50500
2025-05-09 08:33:48 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 08:33:48 - services.voice - ERROR - Error Data: None
2025-05-09 08:33:48 - services.voice - INFO - Retrying after 50500 error, attempt 2/3
2025-05-09 08:33:48 - services.voice - INFO - Retry attempt 1 with simplified text...
2025-05-09 08:33:48 - services.voice - INFO - Simplified text: . . . www.weather.com.cnhttpww...
2025-05-09 08:33:48 - services.voice - INFO - Retry request parameters: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": ". . . www.weather.com.cnhttpww...", "response_format": "mp3"}
2025-05-09 08:33:48 - services.voice - INFO - Waiting 2 seconds before retry...
2025-05-09 08:33:51 - services.voice - INFO - Response Status Code: 500
2025-05-09 08:33:51 - services.voice - INFO - Response Headers: {'date': 'Fri, 09 May 2025 00:33:51 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 08:33:51 - services.voice - INFO - Response Body: {"code":50500,"message":"Request processing has failed due to some unknown error.","data":null}
2025-05-09 08:33:51 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 08:33:51 - services.voice - ERROR - Error Code: 50500
2025-05-09 08:33:51 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 08:33:51 - services.voice - ERROR - Error Data: None
2025-05-09 08:33:51 - services.voice - INFO - Retrying after 50500 error, attempt 3/3
2025-05-09 08:33:51 - services.voice - INFO - Retry attempt 2 with simplified text...
2025-05-09 08:33:51 - services.voice - INFO - Simplified text: . . . www.weather.com.cnhttpww...
2025-05-09 08:33:51 - services.voice - INFO - Retry request parameters: {"model": "FunAudioLLM/CosyVoice2-0.5B", "voice": "speech:dh_5:tk1duirxtm:oczobtboslxrvrvulccc", "input": ". . . www.weather.com.cnhttpww...", "response_format": "mp3"}
2025-05-09 08:33:51 - services.voice - INFO - Waiting 4 seconds before retry...
2025-05-09 08:33:56 - services.voice - INFO - Response Status Code: 500
2025-05-09 08:33:56 - services.voice - INFO - Response Headers: {'date': 'Fri, 09 May 2025 00:33:56 GMT', 'content-type': 'application/json; charset=utf-8', 'content-length': '95', 'connection': 'keep-alive'}
2025-05-09 08:33:56 - services.voice - INFO - Response Body: {"code":50500,"message":"Request processing has failed due to some unknown error.","data":null}
2025-05-09 08:33:56 - services.voice - ERROR - API Error Response: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 08:33:56 - services.voice - ERROR - Error Code: 50500
2025-05-09 08:33:56 - services.voice - ERROR - Error Message: Request processing has failed due to some unknown error.
2025-05-09 08:33:56 - services.voice - ERROR - Error Data: None
2025-05-09 08:33:56 - services.voice - ERROR - Error during speech generation: 500: å¤šæ¬¡é‡è¯•åä»ç„¶å¤±è´¥: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 08:33:56 - services.voice - ERROR - HTTP Exception in generate_audio: 500: è¯­éŸ³ç”Ÿæˆå¤±è´¥: 500: å¤šæ¬¡é‡è¯•åä»ç„¶å¤±è´¥: {"code": 50500, "message": "Request processing has failed due to some unknown error.", "data": null}
2025-05-09 08:58:56 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 08:59:18 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 08:59:18 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 08:59:58 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 08:59:58 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 08:59:59 - services.voice - ERROR - Training API Error: {'code': 20015, 'message': 'The parameter is invalid. Please check again.', 'data': None}
2025-05-09 09:00:34 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:00:34 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:00:34 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:00:34 - services.voice - INFO - Generating speech with model: fishaudio/fish-speech-1.5, voice: {'uri': 'speech:test_voice:tk1duirxtm:ixeuhdexlbmgopdqkgos'}
2025-05-09 09:00:34 - services.voice - INFO - Request parameters: {"model": "fishaudio/fish-speech-1.5", "voice": {"uri": "speech:test_voice:tk1duirxtm:ixeuhdexlbmgopdqkgos"}, "input": "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚"}
2025-05-09 09:00:35 - services.voice - ERROR - Speech Generation API Error: {'code': 20015, 'message': 'The parameter is invalid. Please check again.', 'data': None}
2025-05-09 09:00:35 - services.voice - ERROR - Error during speech generation: 400: è¯­éŸ³ç”Ÿæˆå¤±è´¥: The parameter is invalid. Please check again.
2025-05-09 09:01:12 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:01:12 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:01:13 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:01:13 - services.voice - INFO - Generating speech with model: fishaudio/fish-speech-1.5, voice: speech:test_voice:tk1duirxtm:tjajaetjqkbeamuoctee
2025-05-09 09:01:13 - services.voice - INFO - Request parameters: {"model": "fishaudio/fish-speech-1.5", "voice": "speech:test_voice:tk1duirxtm:tjajaetjqkbeamuoctee", "input": "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚"}
2025-05-09 09:03:56 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:03:56 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:03:56 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:03:56 - services.voice - INFO - Generating speech with model: fishaudio/fish-speech-1.5, voice: speech:test_voice:tk1duirxtm:jupewrkzodvqpgboyqzb
2025-05-09 09:03:56 - services.voice - INFO - Request parameters: {"model": "fishaudio/fish-speech-1.5", "voice": "speech:test_voice:tk1duirxtm:jupewrkzodvqpgboyqzb", "input": "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚"}
2025-05-09 09:04:50 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:04:50 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:04:52 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:04:52 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:04:59 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:05:00 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:09:59 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:12:05 - services.voice - INFO - Generating speech with model: fishaudio/fish-speech-1.5, voice: speech:test_voice:tk1duirxtm:jupewrkzodvqpgboyqzb
2025-05-09 09:12:05 - services.voice - INFO - Request parameters: {"model": "fishaudio/fish-speech-1.5", "voice": "speech:test_voice:tk1duirxtm:jupewrkzodvqpgboyqzb", "input": "ä½ å¥½ï¼Œè¿™æ˜¯ä¸€ä¸ªæµ‹è¯•ã€‚ä»Šå¤©å¤©æ°”çœŸä¸é”™ï¼Œé˜³å…‰æ˜åªšï¼Œè®©äººå¿ƒæƒ…æ„‰æ‚¦ã€‚"}
2025-05-09 09:12:09 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:15:00 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 09:15:32 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 21:18:08 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
2025-05-09 21:18:09 - services.voice - INFO - VoiceService initialized with API URL: https://api.siliconflow.cn/v1
